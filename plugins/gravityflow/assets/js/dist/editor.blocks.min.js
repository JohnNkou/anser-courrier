!function(){"use strict";var e,t={7817:function(e,t,n){var a=React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M1151 960h316q-1-3-2.5-8.5t-2.5-7.5l-212-496h-708l-212 496q-1 3-2.5 8.5t-2.5 7.5h316l95 192h320zm513 30v482q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-482q0-62 25-123l238-552q10-25 36.5-42t52.5-17h832q26 0 52.5 17t36.5 42l238 552q25 61 25 123z"})),r=n(9137),o=n(5952),l=n(5418),i=n(6140),s=n(2611),c=n(7063),u=n(2716);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}var p=window.wp,v=p.components.BaseControl,y=p.compose.withState,g=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,m()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props,t=e.isMulti,n=e.setState,a=e.options,r=e.value,o=e.label,l=e.id,i=e.help,s=e.className,c=e.onChange;return React.createElement(v,{label:o,id:l,help:i,className:s},React.createElement(u.ZP,{isMulti:t,value:r,onChange:function(e){n({value:e}),c(e)},menuPlacement:"auto",options:a,styles:{menuPortal:function(e){return d(d({},e),{},{zIndex:9999})}},menuPortalTarget:document.body}))}}])}(p.element.Component),w=y()(g),h=n(9509),b=n.n(h);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=window.wp.data.registerStore,_=window.wp.apiFetch,C={setForms:function(e){return{type:"SET_FORMS",forms:e}},receiveForms:function(e){return{type:"RECEIVE_FORMS",path:e}}},S=(E("gravityflow/workflow",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forms:[]},t=arguments.length>1?arguments[1]:void 0;return"SET_FORMS"===t.type?R(R({},e),{},{forms:t.forms}):e},actions:C,selectors:{receiveForms:function(e){return e.forms}},controls:{RECEIVE_FORMS:function(e){return _({path:e.path})}},resolvers:{receiveForms:function(){return b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.receiveForms("/gf/v2/workflow/forms/");case 3:t=e.sent,e.next=11;break;case 6:e.prev=6,e.t0=e.catch(0),t="error";case 11:return e.abrupt("return",C.setForms(t));case 12:case"end":return e.stop()}}),e,null,[[0,6]])}))()}}}),n(7363));function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}var O=window.wp,Z=O.i18n.__,D=O.components,N=D.Spinner,x=D.SelectControl,j=O.data.withSelect,I=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,F()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props,t=e.selectedForms,n=e.className,a=e.forms,r=e.selectedFields,o=e.onFieldsChange,l=e.onFormsChange,i=e.isMulti;if(void 0===a)return React.createElement("p",{className:n},React.createElement(N,null),Z("Loading","gravityflow"));if("error"===a)return React.createElement("p",null,Z("Some settings are hidden because you don't have sufficient permissions.","gravityflow"));if(!a)return React.createElement("p",null,Z("No forms","gravityflow"));var s=[];i||s.push({label:Z("Select A Workflow Form","gravityflowblocks"),value:""}),Object.keys(a).forEach((function(e){s.push({label:a[e].title,value:a[e].id})}));var c=[],u=1===t.length&&a[t.map((function(e){return e.value}))];return u&&Object.keys(u.fields).forEach((function(e){var t=u.fields[e];if(t.inputs){var n=t.inputs.map((function(e){return{label:e.label,value:e.id}}));c.push({label:t.label,options:n})}else c.push({label:t.label,value:t.id.toString()})})),React.createElement(S.Fragment,null,(void 0===i||i)&&React.createElement(w,{isMulti:!0,label:Z("Filter Forms","gravityflow"),value:t,onChange:l,options:s}),!1===i&&React.createElement(x,{label:Z("Filter Forms","gravityflow"),value:t?t.value:"",onChange:function(e){for(var t=0;t<s.length;t++)if(""===e||s[t].value===parseInt(e)){var n={label:s[t].label,value:s[t].value};l(n);break}},options:s}),u&&void 0!==r&&React.createElement(w,{isMulti:!0,label:Z("Select Fields","gravityflow"),value:r,onChange:o,options:c}))}}])}(O.element.Component),B=j((function(e){return{forms:e("gravityflow/workflow").receiveForms()}}))(I),P=n(7707);function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(J=function(){return!!e})()}var L=window.wp,q=L.i18n.__,A=L.editor.InspectorControls,T=L.components,z=T.PanelBody,M=T.ToggleControl,U=T.TextControl,V=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,J()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props,t=e.setAttributes,n=e.timeline,a=e.stepStatus,r=e.workflowInfo,o=e.sidebar,l=e.backLink,i=e.backLinkText,s=e.backLinkUrl,c=React.createElement("div",{className:"field-value"}),u=r&&React.createElement("div",{key:"gravityflow-workflow-details",id:"gravityflow-workflow-details"},React.createElement("strong",null,q("Workflow","gravityflow")),React.createElement("div",{id:"entry-id"},q("Entry ID:","gravityflow")," ",c),React.createElement("div",{id:"submitted"},q("Submitted:","gravityflow"),c),React.createElement("div",{id:"created-by"},q("Submitted by:","gravityflow"),c),React.createElement("div",{id:"status"},q("Status:","gravityflow"),c),React.createElement("hr",{style:{marginTop:"10px"}})),f=a&&React.createElement("div",{key:"gravityflow-step-status",id:"gravityflow-step-status"},React.createElement("div",{key:"step-status",id:"step-status"},React.createElement("strong",null,q("Step Name (Status)","gravityflow"))),React.createElement("div",{key:"assignee-status",id:"assignee-status"},q("Assignee:","gravityflow"),c," ",q("(status)","gravityflow"))),d=function(e){return React.createElement("div",{key:"timeline-item-"+e,className:"timeline-item"},React.createElement("div",{className:"timeline-icon"}),React.createElement("div",{className:"timeline-details"},React.createElement("div",{className:"timeline-meta"},React.createElement("div",{className:"timeline-user"}),React.createElement("div",{className:"timeline-date"})),React.createElement("div",{className:"timeline-note"}),React.createElement("div",{className:"timeline-note-half"})))},m=n&&React.createElement("div",{key:"timeline"},React.createElement("strong",null,q("Timeline","gravityflow")),React.createElement("div",{id:"timeline"},d(1),d(2))),p=React.createElement("div",{key:"workflow-box"},u,f);return[React.createElement(A,{key:"detail-inspector"},React.createElement(z,{title:q("Display Settings","gravityflow")},React.createElement(M,{label:q("Timeline","gravityflow"),checked:n,onChange:function(){return t({timeline:!n})}}),React.createElement(M,{label:q("Step Status","gravityflow"),checked:a,onChange:function(){return t({stepStatus:!a})}}),React.createElement(M,{label:q("Workflow Details","gravityflow"),checked:r,onChange:function(){return t({workflowInfo:!r})}}),React.createElement(M,{label:q("Sidebar","gravityflow"),checked:o,onChange:function(){return t({sidebar:!o})}}),React.createElement(M,{label:q("Back Link","gravityflow"),checked:l,onChange:function(){return t({backLink:!l})}}),l&&React.createElement("div",null,React.createElement(U,{label:q("Back Link Text","gravityforms"),value:i,onChange:function(e){return t({backLinkText:e})}}),React.createElement(U,{label:q("Custom Inbox URL (Optional)","gravityforms"),value:s,onChange:function(e){return t({backLinkUrl:e})}})))),React.createElement("div",{key:"detail-view",id:"detail-view",className:"detail-view"},l&&i,React.createElement("div",{id:"container"},React.createElement("div",{key:"main",id:"main"},React.createElement("div",{id:"entry-details"},(0,P.Z)(Array(5)).map((function(e,t){return function(e){return React.createElement("div",{key:"field-value-"+e},React.createElement("div",{className:"field-label-container"},React.createElement("div",{className:"field-label"})),c)}(t)}))),!o&&p,o&&m),o&&React.createElement("div",{key:"sidebar",id:"sidebar"},p)),!o&&m)]}}])}(L.element.Component),W=V,G=n(6796);function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}var Q=window.wp,K=Q.i18n.__,X=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,H()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props.forms_count;return React.createElement("div",{className:"gravityflow-filters"},React.createElement("div",{className:"gravityflow-id-input"},K("ID","gravityflow")),K("Start:","gravityflow"),React.createElement("div",{className:"gravityflow-date-input"},K("yyyy-mm-dd","gravityflow")),K("End:","gravityflow"),React.createElement("div",{className:"gravityflow-date-input"},K("yyyy-mm-dd","gravityflow")),1!==e&&React.createElement("div",{className:"gravityflow-filter-select"},K("Select a Workflow Form","gravityflow")),1===e&&React.createElement("div",{className:"gravityflow-filter-select"},K("Select a field","gravityflow")),React.createElement("div",{className:"gravityflow-filter-button"},K("Apply","gravityflow")))}}])}(Q.element.Component),Y=X;function $(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($=function(){return!!e})()}var ee=window.wp,te=ee.i18n.__,ne=ee.components.Spinner,ae=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,$()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props,t=e.stepHighlight,n=e.idColumn,a=e.submitterColumn,r=e.stepColumn,o=e.actionsColumn,l=e.lastUpdated,i=e.dueDate,s=e.className,c=e.selectedForms,u=e.selectedFields,f=e.entryData,d=e.liveData,m=e.columnOrder,p=e.displayFilters,v=void 0===p;if(void 0===f||void 0===f.rows)return React.createElement("p",{className:s},React.createElement(ne,null),te("Loading","gravityflow"));var y={id:{enabled:n,title:te("ID","gravityflow")},actions:{enabled:o,title:""},form_title:{enabled:0===c.length||c.length>1,title:te("Form","gravityflow")},created_by:{enabled:a,title:te("Submitter","gravityflow")},workflow_step:{enabled:r,title:te("Step","gravityflow")},workflow_final_status:{enabled:!0,title:te("Status","gravityflow")},date_created:{enabled:!0,title:te("Submitted","gravityflow")},fields:u,last_updated:{enabled:l,title:te("Last Updated","gravityflow")},due_date:{enabled:i,title:te("Due date","gravityflow")}},g=[];m.forEach((function(e){g[e]=y[e]}));var w=[];if(Object.keys(g).forEach((function(e){"fields"===e?u.forEach((function(e){w.push({key:e.value,title:e.label})})):g[e].enabled&&w.push({key:e,title:g[e].title})})),!d){var h={};w.forEach((function(e){h[e.key]=React.createElement("div",{style:{width:"auto",backgroundColor:v?"#f4f5fb":"#eee",height:"10px"}},"Â ")})),f.rows=(0,P.Z)(Array(10)).map((function(e,t){var n={};return(0,G.Z)(n,h),n.id=t+1,0===t&&(n.step_highlight="red"),n}))}var b=v?"gravityflow-entry-table--inbox":"gravityflow-entry-table--status";return React.createElement("div",{className:b},p&&React.createElement(Y,{formsCount:c.length}),React.createElement("table",{className:"gravityflow-entry-table"},React.createElement("thead",null,v&&React.createElement("tr",{colSpan:w.length},React.createElement("th",{colSpan:w.length,className:"gravityflow-entry-table__header"},React.createElement("div",{className:"gravityflow-entry-table__header-div"},React.createElement("i",{className:"gravityflow-entry-table__header-search-icon gflow-icon gflow-icon--search"}),React.createElement("div",{className:"gform-input gravityflow-entry-table__header-search-input"}),React.createElement("i",{className:"gravityflow-entry-table__header-gear-icon gflow-icon gflow-icon--settings"})))),React.createElement("tr",{className:"gravityflow-entry-table__header-columns"},w.map((function(e){var t=e.key;return React.createElement("th",{key:t},e.title)})))),React.createElement("tbody",null,f.rows.map((function(e){var n=t?e.step_highlight:"";return React.createElement("tr",{key:e.id,style:{borderColor:n}},w.map((function(t){var n=t.key,a="actions"===n?React.createElement("div",{className:"gflow-grid__actions"},React.createElement("i",{className:"gflow-grid__actions-trigger gflow-icon gflow-icon--more-vertical",style:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",transform:"rotate(90deg)"}})):e[n];return React.createElement("td",{key:n},a)})))})))))}}])}(ee.element.Component),re=ae;function oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oe=function(){return!!e})()}var le=window.wp,ie=le.apiFetch,se=le.url.addQueryArgs,ce=le.i18n.__,ue=le.compose.withState,fe=le.editor.InspectorControls,de=le.components,me=de.PanelBody,pe=de.PanelRow,ve=de.ToggleControl,ye=de.Button,ge=de.ButtonGroup,we=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,oe()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"componentWillUnmount",value:function(){le.data.dispatch("core/editor").editPost({meta:{_gravityflow_inbox_forms_json:"",_gravityflow_inbox_fields_json:""}})}},{key:"componentDidMount",value:function(){this.getInboxEntries(this.props.selectedForms,this.props.selectedFields)}},{key:"componentDidUpdate",value:function(e){e.selectedForms===this.props.selectedForms&&e.selectedFields===this.props.selectedFields||this.getInboxEntries(this.props.selectedForms.map((function(e){return e.value})),this.props.selectedFields.map((function(e){return e.value})))}},{key:"getInboxEntries",value:function(e,t){var n=this;ie({path:se("/gf/v2/inbox-entries/",{"form-ids":e,fields:t,"last-updated":!0,"due-date":!0,"actions-column":!0})}).then((function(e){n.props.setState({entryData:e,loaded:!0})})).catch((function(){n.props.setState({entryData:[],loaded:!0})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.attributes,a=n.stepHighlight,r=n.idColumn,o=n.submitterColumn,l=n.stepColumn,i=n.actionsColumn,s=n.lastUpdated,c=n.dueDate,u=n.selectedFormsJson,f=n.selectedFieldsJson,d=n.timeline,m=n.stepStatus,p=n.workflowInfo,v=n.sidebar,y=n.backLink,g=n.backLinkText,w=n.backLinkUrl,h=t.setAttributes,b=t.setState,k=t.currentView,R=t.liveData,E=t.entryData,_=f?JSON.parse(f):[],C=u?JSON.parse(u):[],S="detail"===k;return[React.createElement(fe,{key:"inbox-inspector"},React.createElement(me,{title:ce("View","gravityflow")},React.createElement(ge,null,React.createElement(ye,{className:"view-toggle-button",isDefault:S,onClick:function(){return b({currentView:"list"})},style:{zIndex:0},isPrimary:!S},ce("List","gravityflow")),React.createElement(ye,{className:"view-toggle-button",isDefault:!S,onClick:function(){return b({currentView:"detail"})},style:{zIndex:0},isPrimary:S},"Detail")),!S&&React.createElement(pe,null,React.createElement(ve,{label:ce("Preview Live Data","gravityflow"),checked:R,onChange:function(){e.getInboxEntries(C.map((function(e){return e.value})),_.map((function(e){return e.value}))),b({liveData:!R})}}))),!S&&React.createElement("div",null,React.createElement(me,{title:ce("Display Settings","gravityflow")},React.createElement(ve,{label:ce("Highlight","gravityflow"),checked:a,onChange:function(){return h({stepHighlight:!a})}}),React.createElement(ve,{label:ce("Entry ID","gravityflow"),checked:r,onChange:function(){return h({idColumn:!r})}}),React.createElement(ve,{label:ce("Approval Actions","gravityflow"),checked:i,onChange:function(){return h({actionsColumn:!i})}}),React.createElement(ve,{label:ce("Submitter","gravityflow"),checked:o,onChange:function(){return h({submitterColumn:!o})}}),React.createElement(ve,{label:ce("Step","gravityflow"),checked:l,onChange:function(){return h({stepColumn:!l})}}),React.createElement(ve,{label:ce("Last updated","gravityflow"),checked:s,onChange:function(){return h({lastUpdated:!s})}}),React.createElement(ve,{label:ce("Due Date","gravityflow"),checked:c,onChange:function(){return h({dueDate:!c})}}),React.createElement(B,{isMulti:!0,selectedForms:C,selectedFields:_,onFormsChange:function(t){h({selectedFormsJson:JSON.stringify(t),selectedFieldsJson:""});var n=t.map((function(e){return e.value}));e.getInboxEntries(n,[])},onFieldsChange:function(t){h({selectedFieldsJson:JSON.stringify(t)});var n=t.map((function(e){return e.value}));e.getInboxEntries(t.map((function(e){return e.value})),n)}})))),!S&&React.createElement(re,{key:"gravityflow-inbox",stepHighlight:a,idColumn:r,submitterColumn:o,stepColumn:l,actionsColumn:i,lastUpdated:s,dueDate:c,selectedForms:C,selectedFields:_,liveData:R,entryData:E,columnOrder:["id","actions","form_title","created_by","workflow_step","date_created","fields","last_updated","due_date"]}),S&&React.createElement(W,{key:"gravityflow-detail",timeline:d,stepStatus:m,workflowInfo:p,sidebar:v,backLink:y,backLinkText:g,backLinkUrl:w,setAttributes:h})]}}])}(le.element.Component),he=ue({entryData:{rows:[],columns:[]},liveData:!1,currentView:"list"})(we),be=window.wp,ke=be.i18n.__;(0,be.blocks.registerBlockType)("gravityflow/inbox",{title:ke("Workflow Inbox","gravityflow"),description:ke("Displays the workflow inbox.","gravityflow"),icon:{src:a},keywords:[ke("Gravity Flow"),ke("Gravity")],category:"widgets",supports:{multiple:!1,html:!1,anchor:!0},attributes:{stepHighlight:{type:"boolean",default:!0},idColumn:{type:"boolean",default:!0},submitterColumn:{type:"boolean",default:!0},stepColumn:{type:"boolean",default:!0},actionsColumn:{type:"boolean",default:!1},lastUpdated:{type:"boolean",default:!1},dueDate:{type:"boolean",default:!1},selectedFormsJson:{type:"string",source:"meta",meta:"_gravityflow_inbox_forms_json",default:""},selectedFieldsJson:{type:"string",source:"meta",meta:"_gravityflow_inbox_fields_json",default:""},timeline:{type:"boolean",default:!0},stepStatus:{type:"boolean",default:!0},workflowInfo:{type:"boolean",default:!0},sidebar:{type:"boolean",default:!0},backLink:{type:"boolean",default:!1},backLinkText:{type:"string",default:ke("Return to list","gravityflow")},backLinkUrl:{type:"string",default:""}},edit:he,save:function(){return null}});var Re=React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M384 1152q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm192-448q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm428 481l101-382q6-26-7.5-48.5t-38.5-29.5-48 6.5-30 39.5l-101 382q-60 5-107 43.5t-63 98.5q-20 77 20 146t117 89 146-20 89-117q16-60-6-117t-72-91zm660-33q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm-640-640q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm448 192q0-53-37.5-90.5t-90.5-37.5-90.5 37.5-37.5 90.5 37.5 90.5 90.5 37.5 90.5-37.5 37.5-90.5zm320 448q0 261-141 483-19 29-54 29h-1402q-35 0-54-29-141-221-141-483 0-182 71-348t191-286 286-191 348-71 348 71 286 191 191 286 71 348z"}));function Ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ee=function(){return!!e})()}var _e=window.wp,Ce=_e.i18n.__,Se=_e.editor.InspectorControls,Fe=_e.components,Oe=Fe.PanelBody,Ze=Fe.ToggleControl,De=Fe.Button,Ne=Fe.ButtonGroup,xe=_e.compose.withState,je=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,Ee()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"componentWillUnmount",value:function(){_e.data.dispatch("core/editor").editPost({meta:{_gravityflow_status_fields_json:"",_gravityflow_status_forms_json:""}})}},{key:"render",value:function(){var e=this.props,t=e.attributes,n=t.idColumn,a=t.submitterColumn,r=t.stepColumn,o=t.lastUpdated,l=t.dueDate,i=t.selectedFormsJson,s=t.selectedFieldsJson,c=t.timeline,u=t.stepStatus,f=t.workflowInfo,d=t.sidebar,m=t.backLink,p=t.backLinkText,v=t.backLinkUrl,y=t.displayAll,g=t.allowAnonymous,w=e.setAttributes,h=e.setState,b=e.currentView,k=e.liveData,R=s?JSON.parse(s):[],E=i?JSON.parse(i):[],_="detail"===b;return[React.createElement(Se,{key:"inbox-inspector"},React.createElement(Oe,{title:Ce("View","gravityflow")},React.createElement(Ne,null,React.createElement(De,{className:"view-toggle-button",isDefault:!0,onClick:function(){return h({currentView:"list"})},style:{zIndex:0},isPrimary:!_},Ce("List","gravityflow")),React.createElement(De,{className:"view-toggle-button",isDefault:!0,onClick:function(){return h({currentView:"detail"})},style:{zIndex:0},isPrimary:_},"Detail"))),!_&&React.createElement("div",null,React.createElement(Oe,{title:Ce("Display Settings","gravityflow")},React.createElement(Ze,{label:Ce("Entry ID","gravityflow"),checked:n,onChange:function(){return w({idColumn:!n})}}),React.createElement(Ze,{label:Ce("Submitter","gravityflow"),checked:a,onChange:function(){return w({submitterColumn:!a})}}),React.createElement(Ze,{label:Ce("Step","gravityflow"),checked:r,onChange:function(){return w({stepColumn:!r})}}),React.createElement(Ze,{label:Ce("Last updated","gravityflow"),checked:o,onChange:function(){return w({lastUpdated:!o})}}),React.createElement(Ze,{label:Ce("Due Date","gravityflow"),checked:l,onChange:function(){return w({dueDate:!l})}})),React.createElement(B,{isMulti:!0,selectedForms:E,selectedFields:R,onFormsChange:function(e){w({selectedFormsJson:JSON.stringify(e),selectedFieldsJson:""})},onFieldsChange:function(e){w({selectedFieldsJson:JSON.stringify(e)})}}),React.createElement(Oe,{title:Ce("Danger Zone","gravityflow"),initialOpen:!1},React.createElement(Ze,{label:Ce("Display All Entries","gravityflow"),checked:y,onChange:function(){return w({displayAll:!y})},help:Ce("Displays all entries to all logged in users regardless of their permissions.","gravityflow")}),y&&React.createElement(Ze,{label:Ce("Make all entries public","gravityflow"),checked:g,onChange:function(){return w({allowAnonymous:!g})},help:Ce("Displays all entries to all site visitors, including anonymous. This will also allow search engines to index the entries.","gravityflow")})))),!_&&React.createElement(re,{key:"gravityflow-status",idColumn:n,submitterColumn:a,stepColumn:r,lastUpdated:o,dueDate:l,selectedForms:E,selectedFields:R,liveData:k,entryData:{rows:[]},columnOrder:["id","date_created","form_title","created_by","workflow_step","workflow_final_status","fields","last_updated","due_date"],displayFilters:!0}),_&&React.createElement(W,{key:"gravityflow-detail",timeline:c,stepStatus:u,workflowInfo:f,sidebar:d,backLink:m,backLinkText:p,backLinkUrl:v,setAttributes:w})]}}])}(_e.element.Component),Ie=xe({currentView:"list"})(je),Be=window.wp,Pe=Be.i18n.__;(0,Be.blocks.registerBlockType)("gravityflow/status",{title:Pe("Workflow Status","gravityflow"),description:Pe("Display the workflow status list.","gravityflow"),icon:{src:Re},keywords:[Pe("Gravity Flow"),Pe("Gravity")],category:"widgets",supports:{multiple:!1,html:!1,anchor:!0},attributes:{idColumn:{type:"boolean",default:!0},submitterColumn:{type:"boolean",default:!0},stepColumn:{type:"boolean",default:!0},lastUpdated:{type:"boolean",default:!1},dueDate:{type:"boolean",default:!1},selectedFormsJson:{type:"string",source:"meta",meta:"_gravityflow_status_forms_json",default:""},selectedFieldsJson:{type:"string",source:"meta",meta:"_gravityflow_status_fields_json",default:""},timeline:{type:"boolean",default:!0},stepStatus:{type:"boolean",default:!0},workflowInfo:{type:"boolean",default:!0},sidebar:{type:"boolean",default:!0},backLink:{type:"boolean",default:!1},backLinkText:{type:"string",default:Pe("Return to list","gravityflow")},backLinkUrl:{type:"string",default:""},displayAll:{type:"boolean",source:"meta",meta:"_gravityflow_status_display_all",default:!1},allowAnonymous:{type:"boolean",source:"meta",meta:"_gravityflow_status_allow_anonymous",default:!1}},edit:Ie,save:function(){return null}});var Je=React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M888 1184l116-116-152-152-116 116v56h96v96h56zm440-720q-16-16-33 1l-350 350q-17 17-1 33t33-1l350-350q17-17 1-33zm80 594v190q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q63 0 117 25 15 7 18 23 3 17-9 29l-49 49q-14 14-32 8-23-6-45-6h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113v-126q0-13 9-22l64-64q15-15 35-7t20 29zm-96-738l288 288-672 672h-288v-288zm444 132l-92 92-288-288 92-92q28-28 68-28t68 28l152 152q28 28 28 68t-28 68z"}));function Le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Le=function(){return!!e})()}var qe=window.wp,Ae=qe.editor.InspectorControls,Te=qe.data.withSelect,ze=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,Le()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"componentWillUnmount",value:function(){qe.data.dispatch("core/editor").editPost({meta:{_gravityflow_submit_forms_json:""}})}},{key:"render",value:function(){var e=this.props,t=e.attributes.selectedFormsJson,n=e.forms,a=e.setAttributes,r=t?JSON.parse(t):[],o=[];0===r.length?Object.keys(n).forEach((function(e){n[e].isPublished&&o.push({label:n[e].title,value:n[e].id})})):o=r;var l=o.map((function(e){return React.createElement("div",{key:e.value},e.label)}));return[React.createElement(Ae,{key:"inbox-inspector"},React.createElement(B,{isMulti:!0,selectedForms:r,onFormsChange:function(e){a({selectedFormsJson:JSON.stringify(e)})}})),React.createElement("div",{key:"form-list"},l)]}}])}(qe.element.Component),Me=Te((function(e){return{forms:e("gravityflow/workflow").receiveForms()}}))(ze),Ue=window.wp,Ve=Ue.i18n.__;(0,Ue.blocks.registerBlockType)("gravityflow/submit",{title:Ve("Workflow Submit","gravityflow"),description:Ve("Display links to workflow forms.","gravityflow"),icon:{src:Je},keywords:[Ve("Gravity Flow"),Ve("Gravity")],category:"widgets",supports:{multiple:!1,html:!1,anchor:!0},attributes:{selectedFormsJson:{type:"string",source:"meta",meta:"_gravityflow_submit_forms_json",default:""}},edit:Me,save:function(){return null}});var We=React.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M640 768v512H384V768h256zm384-512v1024H768V256h256zm1024 1152v128H0V0h128v1408h1920zm-640-896v768h-256V512h256zm384-384v1152h-256V128h256z"}));function Ge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ge=function(){return!!e})()}var He=window.wp,Qe=He.i18n.__,Ke=He.components.SelectControl,Xe=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,Ge()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.range,a=e.onRangeChange,r=e.selectedFormJson,o=e.onFormsChange,l=e.category,i=e.onCategoryChange,s=e.assignee,c=e.assignees,u=e.onAssigneeChange,f=e.step_id,d=e.steps,m=e.onStepChange,p=r?JSON.parse(r):[];return[React.createElement(S.Fragment,{key:t},React.createElement(Ke,{label:Qe("Range","gravityflowblocks"),value:n,onChange:function(e){a(e)},options:[{value:"last-12-months",label:Qe("Last 12 months","gravityflowblocks")},{value:"last-6-months",label:Qe("Last 6 months","gravityflowblocks")},{value:"last-3-months",label:Qe("Last 3 months","gravityflowblocks")}]}),React.createElement(B,{isMulti:!1,selectedForms:p,onFormsChange:function(e){o(e)}}),""!==p.value&&React.createElement(Ke,{label:Qe("Category","gravityflowblocks"),value:l,onChange:function(e){i(e)},options:[{value:"month",label:Qe("Month","gravityflowblocks")},{value:"assignee",label:Qe("Assignee","gravityflowblocks")},{value:"step",label:Qe("Step","gravityflowblocks")}]}),"step"===l&&React.createElement(Ke,{label:Qe("Step","gravityflowblocks"),value:f,onChange:function(e){m(e)},options:d}),c&&React.createElement(Ke,{label:Qe("Assignee","gravityflowblocks"),value:s,onChange:function(e){u(e)},options:c}))]}}])}(He.element.Component),Ye=Xe;function $e(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($e=function(){return!!e})()}var et=window.wp.components.Button,tt=window.wp.i18n.__,nt=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,$e()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"render",value:function(){return React.createElement(S.Fragment,null,React.createElement("select",{disabled:!0,key:"range"},React.createElement("option",null,tt("Last 12 month","gravityflowblocks"))),React.createElement("select",{disabled:!0,key:"form"},React.createElement("option",null,tt("Select A Workflow Form","gravityflowblocks"))),React.createElement(et,{disabled:!0,key:"filter",isSecondary:!0},"Filter"))}}])}(window.wp.element.Component),at=nt;function rt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rt=function(){return!!e})()}var ot=window.wp,lt=ot.i18n.__,it=ot.editor.InspectorControls,st=ot.apiFetch,ct=ot.url.addQueryArgs,ut=ot.compose.withState,ft=ot.components,dt=ft.PanelBody,mt=ft.ToggleControl,pt=ft.Spinner,vt=function(e){function t(){return(0,r.Z)(this,t),e=this,n=t,a=arguments,n=(0,i.Z)(n),(0,l.Z)(e,rt()?Reflect.construct(n,a||[],(0,i.Z)(e).constructor):n.apply(e,a));var e,n,a}return(0,s.Z)(t,e),(0,o.Z)(t,[{key:"componentDidMount",value:function(){this.getSteps(),this.getReports()}},{key:"componentDidUpdate",value:function(e){e.attributes.range===this.props.attributes.range&&e.attributes.selectedFormJson===this.props.attributes.selectedFormJson&&e.attributes.category===this.props.attributes.category&&e.attributes.stepId===this.props.attributes.stepId&&e.attributes.assignee===this.props.attributes.assignee||this.getReports(this.props)}},{key:"getSelectedForm",value:function(){var e=this.props.attributes.selectedFormJson;return e?JSON.parse(e).value:""}},{key:"getSteps",value:function(e){var t=this;void 0===e&&(e=this.getSelectedForm());var n=[{label:lt("All Steps","gravityflow"),value:""}],a=[];""!==e&&st({path:"gf/v2/workflow/forms/"+e+"/steps"}).then((function(e){Object.keys(e).forEach((function(t){n.push({label:e[t].name,value:e[t].id}),a[e[t].id]=[{label:lt("All Assignees","gravityflow"),value:""}],e[t].assignees.length&&e[t].assignees.forEach((function(n){a[e[t].id].push({label:n.name,value:n.key})}))})),t.props.setState({steps:n,assignees:a})}))}},{key:"getReports",value:function(e){var t=this,n=this.getSelectedForm();void 0===e&&(e=this.props),this.props.setState({reports:{}}),st({path:ct("/gf/v2/workflow/reports/",{form:n,range:""===e.attributes.range?"last-12-months":e.attributes.range,category:e.attributes.category,"step-id":e.attributes.stepId,assignee:e.attributes.assignee})}).then((function(e){if(t.props.setState({reports:e}),e.hasOwnProperty("table")){var n=window.google.visualization.arrayToDataTable(JSON.parse(e.table)),a=JSON.parse(e.options);new window.google.charts.Bar(document.querySelector('[data-block="'+t.props.clientId+'"] .gravityflow_chart')).draw(n,a)}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.attributes,a=n.range,r=n.selectedFormJson,o=n.category,l=n.stepId,i=n.assignee,s=n.displayFilter,c=t.steps,u=t.assignees,f=t.reports,d=t.setAttributes,m=function(t){return React.createElement(Ye,{name:t.name,range:a,onRangeChange:function(e){d({range:e})},selectedFormJson:r,onFormsChange:function(e){d({selectedFormJson:JSON.stringify(e),category:"",stepId:""})},category:o,onCategoryChange:function(t){d({category:t,stepId:"",assignee:""}),"step"===t&&e.getSteps(e.getSelectedForm())},stepId:l,onStepChange:function(e){d({stepId:e,assignee:""})},steps:c,assignee:i,onAssigneeChange:function(e){d({assignee:e})},assignees:u[l]})};return[React.createElement(it,{key:"inbox-inspector"},React.createElement(dt,{title:lt("Display Settings","gravityflowblocks")},React.createElement(mt,{label:lt("Display filters","gravityflowblocks"),checked:s,onChange:function(){return d({displayFilter:!s})}})),React.createElement(dt,{title:lt("Filter Settings","gravityflowblocks")},React.createElement(m,{name:"panel-body-filter"}))),s&&React.createElement(at,{key:"block-content-filter"}),"string"!=typeof f&&!f.hasOwnProperty("table")&&React.createElement("div",{key:"gravityflow_chart_loading",className:"gravityflow_chart"},React.createElement(pt,null),lt("Loading","gravityflow")),f.hasOwnProperty("table")&&React.createElement("div",{key:"gravityflow_chart_top_level",className:"gravityflow_chart"}),"string"==typeof f&&React.createElement("div",{key:"gravityflow_chart_no_data",className:"gravityflow_chart"},lt("No data to display","gravityflowblocks"))]}}])}(ot.element.Component),yt=ut({steps:[],assignees:[],reports:{}})(vt),gt=window.wp,wt=gt.i18n.__;(0,gt.blocks.registerBlockType)("gravityflow/reports",{title:wt("Workflow Reports","gravityflow"),description:wt("Displays the workflow reports.","gravityflow"),icon:{src:We},keywords:[wt("Gravity Flow"),wt("Gravity")],category:"widgets",supports:{multiple:!0,html:!1,anchor:!0},attributes:{displayFilter:{type:"boolean",default:!1},range:{type:"string",default:"last-12-months"},selectedFormJson:{type:"string",default:""},category:{type:"string",default:""},stepId:{type:"string",default:""},assignee:{type:"string",default:""}},edit:yt,save:function(){return null}})},7363:function(e){e.exports=React},1533:function(e){e.exports=ReactDOM}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,e=[],a.O=function(t,n,r,o){if(!n){var l=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],o=e[u][2];for(var i=!0,s=0;s<n.length;s++)(!1&o||l>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(i=!1,o<l&&(l=o));if(i){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},a.j=883,function(){var e={883:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,l=n[0],i=n[1],s=n[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(s)var u=s(a)}for(t&&t(n);c<l.length;c++)o=l[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},n=self.webpackChunkgravityflow=self.webpackChunkgravityflow||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=a.O(void 0,[194],(function(){return a(7817)}));r=a.O(r)}();